# 地图命名功能说明

## 🎯 功能概述

现在保存地图时可以自定义地图名称，方便组织和管理测试地图。

## 📝 使用方法

### 保存地图

1. **创建或生成地图**
   - 使用鼠标绘制墙壁
   - 或使用 "Generate Maze" 生成迷宫

2. **点击 "Save Map" 按钮**
   - 会弹出地图命名输入框
   - 屏幕会显示半透明遮罩

3. **输入地图名称**
   - 在输入框中输入自定义名称
   - 例如：`test_maze_1`, `complex_map`, `weighted_test`
   - 名称限制：
     - 最大长度 30 个字符
     - 不能包含特殊字符：`/ \ : * ? " < > |`
     - 可以包含字母、数字、下划线、连字符

4. **保存操作**
   - **按 ENTER**：保存地图
     - 如果输入了名称，使用自定义名称
     - 如果留空，使用自动生成的时间戳名称（如 `map_20251116_235959`）
   - **按 ESC**：取消保存

## 💡 使用建议

### 推荐命名规则

```
测试地图命名示例：
- test_simple_open       # 简单开放地图
- test_complex_maze      # 复杂迷宫
- test_weighted_nodes    # 带权重节点的地图
- benchmark_large        # 大型基准测试地图
- scenario_1             # 场景1测试
- corner_cases           # 边界情况测试
```

### 系统测试工作流

```bash
# 1. 创建测试地图集
- 保存为 "test_open_1"
- 保存为 "test_maze_complex"
- 保存为 "test_weights"

# 2. 系统测试
- 加载 "test_open_1"
- 运行所有算法
- 记录结果

- 加载 "test_maze_complex"
- 运行所有算法
- 对比性能
```

## 🎨 界面说明

输入弹窗包含：
- **标题**："Save Map"
- **说明文字**：提示可以留空使用自动命名
- **输入框**：蓝色边框，显示当前输入和光标（|）
- **帮助文字**：键盘操作提示

## 📁 保存位置

所有地图保存在 `maps/` 目录下：
```
maps/
├── test_simple_open.json
├── test_complex_maze.json
├── test_weighted_nodes.json
└── map_20251116_235959.json  # 自动命名
```

## ⌨️ 快捷键

- **输入模式下**：
  - `字母/数字/符号`：输入字符
  - `Backspace`：删除最后一个字符
  - `Enter`：确认保存
  - `Escape`：取消保存

- **输入模式外**：
  - 正常的地图操作（绘制、算法运行等）

## ✨ 功能特点

✅ **智能验证**：自动过滤非法文件名字符
✅ **长度限制**：防止文件名过长
✅ **自动补全**：自动添加 `.json` 扩展名
✅ **灵活选择**：可以使用自定义名称或自动时间戳
✅ **即时反馈**：实时显示输入内容
✅ **易于取消**：随时可以按 ESC 取消

## 🔧 技术实现

- 使用 pygame 的 `KEYDOWN` 事件捕获键盘输入
- 实时更新输入状态和显示
- 验证文件名合法性
- 保持与现有保存逻辑的兼容性
